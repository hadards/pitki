<div class="container">
  <div class="filter-card">
    <div class="filter-grid">
      <input
        type="text"
        [(ngModel)]="searchQuery"
        (ngModelChange)="onSearchChange()"
        placeholder="Search articles..."
        class="filter-input"
      />

      <select [(ngModel)]="selectedCategory" (ngModelChange)="onFilterChange()" class="filter-select">
        <option value="">All Categories</option>
        <option *ngFor="let category of categories" [value]="category.id">{{category.name}}</option>
      </select>

      <select [(ngModel)]="selectedSource" (ngModelChange)="onFilterChange()" class="filter-select">
        <option value="">All Sources</option>
        <option *ngFor="let source of sources" [value]="source">{{source}}</option>
      </select>

      <select [(ngModel)]="selectedDateRange" (ngModelChange)="onFilterChange()" class="filter-select">
        <option value="all">All Time</option>
        <option value="today">Today</option>
        <option value="week">This Week</option>
        <option value="month">This Month</option>
        <option value="custom">Custom Range</option>
      </select>

      <div class="button-group">
        <button (click)="clearFilters()" class="btn btn-clear">Clear</button>
        <button (click)="removeAll()" *ngIf="articles.length > 0" class="btn btn-remove-all">Remove All</button>
      </div>
    </div>

    <div class="date-filters" *ngIf="selectedDateRange === 'custom'">
      <div class="date-filter-group">
        <label class="date-filter-label">From</label>
        <input type="date" [(ngModel)]="customFromDate" (ngModelChange)="onFilterChange()" class="filter-input" />
      </div>
      <div class="date-filter-group">
        <label class="date-filter-label">To</label>
        <input type="date" [(ngModel)]="customToDate" (ngModelChange)="onFilterChange()" class="filter-input" />
      </div>
    </div>
  </div>

  <div *ngIf="error" class="error-alert">{{error}}</div>

  <div *ngIf="loading" class="loading">
    <div class="spinner"></div>
    <p class="loading-text">Loading articles...</p>
  </div>

  <div *ngIf="!loading && !error" class="articles">
    <div *ngIf="articles.length === 0" class="empty-state">
      No articles found. Try adjusting your filters or save some articles via Telegram!
    </div>

    <div *ngFor="let article of articles" class="article-card">
      <div (click)="openArticle(article.url)" class="article-content">
        <div class="article-body">
          <img *ngIf="article.thumbnail_url" [src]="article.thumbnail_url" [alt]="article.title" class="article-thumbnail" />

          <div class="article-info">
            <h3 class="article-title">{{article.title}}</h3>
            <div class="article-meta">
              <span class="badge badge-source">{{article.source}}</span>
              <span class="badge badge-category">{{article.categories?.name || 'Uncategorized'}}</span>
              <span class="article-date">{{getTimeAgo(article.created_at)}}</span>
            </div>
          </div>
        </div>
      </div>

      <div class="article-footer">
        <button (click)="deleteArticle(article)" class="btn-delete">Delete</button>
      </div>
    </div>
  </div>
</div>
